# Apache Camel Telegram Source
#
# Telegram Component documentation: https://camel.apache.org/components/latest/telegram-component.html
# Simple language documentation: https://camel.apache.org/manual/latest/simple-language.html
#
# List of available Apache Camel components: https://camel.apache.org/components/latest/
#
apiVersion: sources.knative.dev/v1alpha1
kind: CamelSource
metadata:
  name: camel-telegram-source
spec:
  source:
    integration:
      dependencies:
      - camel:jackson
    flow:
      from:
        uri: telegram:bots
        parameters:
          authorizationToken: "1332135856:AAHI8MlVWVlsZAIVsHGxeogWMSXEK0ETUpc"
        steps:
          - set-header:
              name: ce-author
              simple: "${body.from.firstName} ${body.from.lastName}"
          - set-header:
              name: ce-chat
              simple: "${body.chat.id}"
          - set-header:
              name: Content-Type
              constant: application/json
          - marshal:
              json: {}
  sink:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: ev
